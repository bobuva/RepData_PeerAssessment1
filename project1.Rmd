Reproducible Research: Peer Assessment 1
========================================

## Loading and preprocessing the data
```{r}
library(ggplot2)
library(plyr)
data <- read.csv("activity.csv")
dailytotals <- aggregate(data$steps, by=list(data$date), FUN=sum)
colnames(dailytotals) <- c("Date","Steps")
dailytotals$Date <- as.Date(dailytotals$Date)
```

## What is mean total number of steps taken per day?

First, we'll look at a histogram of the total number of steps per day through the two-month period covered by the data set.

```{r fig.height=4, fig.width=20}
par(las=2)
ggplot(dailytotals, aes( x = factor(Date), y = Steps)) + geom_histogram(stat= "identity") + theme(axis.text.x = element_text(size=8, angle=45, hjust=1))
```

```{r echo=FALSE}
good <- complete.cases(dailytotals)
totals <- dailytotals[good,]
meanDaily <- mean(totals$Steps)
medianDaily <- median(totals$Steps)
```
For this two-month period, the mean number of steps is `r meanDaily` and the median number of steps is `r medianDaily`.


## What is the average daily activity pattern?
```{r echo=FALSE}
goodrows <- complete.cases(data)
data1 <- data[goodrows,]
avgint <- aggregate(data1$steps, by=list(data1$interval), FUN=mean)
colnames(avgint) = c("Interval", "Average")
plot(avgint$Interval, avgint$Average, type="l", col="blue", main="Average Steps per 5-minute Interval Time Series", xlab="Interval", ylab="Interval Average")
indexMax = which(avgint$Average == max(avgint$Average))
intervalMax = avgint[indexMax, "Interval"]
```

The `r intervalMax` time interval is when the maximum average steps occurs in a day across the two-month data set.
## Imputing missing values

There are `r nrow(data) - nrow(data1)` missing values in the data set.


## Are there differences in activity patterns between weekdays and weekends?

steps <- data$steps
indexNAs <- which(is.na(steps))
intervalsForNAs <- data[indexNAs, "interval"]
averages <- avgint[intervalsForNAs, "Average"]
averages <- averages[!is.na(averages)]

# for each of these indices, I want to retrieve the "interval" value from
# data and then get that interval value's Average from avgint. This value I
# will use to replace the specific NA value.

#steps[which(is.na(steps)),] <- 